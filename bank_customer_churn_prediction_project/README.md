# Описание проекта "Предсказание оттока клиентов банка"

## Цели работы (постановка задачи)

На основе имеющихся исторических данных о поведении клиентов и сведений о расторжении договоров клиентов с банком необходимо построить модель-предиктор (ML-модель прогнозирования) поведения клиентов (уйдет из банка в ближайшее время/останется клиентом банка).
Для оценки качества построенной модели необходимо использовать метрику F1-мера, доведя ее значение до предельно большого. Бейзлайном считается значение F1-меры, равное 0.59. Дополнительно требуется измерять значение AUC-ROC, сравнивая его со значением F1-меры.


## Исходные данные

Доступные следующие данные (признаки) из исходного датасета ([источник данных](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)):
- RowNumber — индекс строки в данных;
- CustomerId — уникальный идентификатор клиента;
- Surname — фамилия;
- CreditScore — кредитный рейтинг;
- Geography — страна проживания;
- Gender — пол;
- Age — возраст;
- Tenure — сколько лет человек является клиентом банка;
- Balance — баланс на счёте;
- NumOfProducts — количество продуктов банка, используемых клиентом;
- HasCrCard — наличие кредитной карты;
- IsActiveMember — активность клиента;
- EstimatedSalary — предполагаемая зарплата.

Целевой признак:
- Exited — факт ухода клиента из банка.


## Результаты работы

Для достижения целей работы были выполнены следующие шаги:
1. Предварительный анализ (обзор) данных (для получения общей информации о признаках, наличии полных дупликатов, аномальных значений - выбросов - в данных и т.п.)
2. Разделение исходного датасета на обучающую, валидационную и тестовую выборки в соотношении 80:20:20
3. Обработка категориальных и нормализация (масштабирование) численных признаков в выборках
4. Исследование баланса классов и борьба с выявленным дисбалансом классов методами upsampling (увеличение выборок) и downsampling (уменьшение выборок)
5. Обучение на исходной (несбалансированной), увеличенной и уменьшенной обучающих выборках, определение значений F1-меры и AUC-ROC на валидационной выборке двух вариантов ML-моделей:
	- модели логистической регрессии;
	- модели случайного леса
6. Выбор наилучшей модели по результатам проверки на валидационной выборке полученных ML-моделей
7. Проверка выбранной наилучшей модели на тестовой выборке (тестирование наилучшей модели)

По результатам выполненной работы было установлено, что наилучшей ML-моделью для прогнозирования ухода в ближайшем будущем клиента из банка является модель случайного леса, обученная на увеличенных выборках (для устранения дисбаланса классов), со следующими основными значениями гиперпараметров:
	- количество деревьев в лесу (n_estimators) = 104,
	- глубина деревьев (max_depth) = 14.
Проверка обученной наилучшей модели (финальное тестирование модели) на отложенной тестовой выборке показала следующие результаты: F1-мера = 0.6109, AUC-ROC = 0.8564. Полученные значения позволяют сделать вывод о решении поставленной задачи (F1-мера превышает заданное значение 0.59), а ROC-кривая и значение AUC-ROC говорят о корректности настройки модели (она работает заведомо лучше случайного предиктора), что свидетельствует о потенциальной возможности использования данной модели в качестве предиктора оттока клиентов банка.